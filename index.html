<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Melbourne 2025 • Checkable Map</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>
  body,html,#map{height:100vh;margin:0;background:#0d1117}
  .legend{
    position:absolute;top:12px;left:50%;transform:translateX(-50%);
    background:rgba(13,17,23,0.9);color:white;padding:10px 18px;
    border-radius:16px;border:1px solid #30363d;box-shadow:0 8px 32px rgba(0,0,0,0.6);
    font-family:system-ui,-apple-system,sans-serif;z-index:1000;
    backdrop-filter:blur(12px);display:flex;align-items:center;gap:16px;
  }
  .legend span{font-weight:600;font-size:15px}
  .dot{width:20px;height:20px;border-radius:50%;box-shadow:0 0 12px;}
  .progress{
    position:absolute;top:70px;left:50%;transform:translateX(-50%);
    background:rgba(13,17,23,0.9);color:#58a6ff;padding:8px 16px;
    border-radius:12px;border:1px solid #30363d;font-weight:600;z-index:1000;
    backdrop-filter:blur(10px);font-size:14px;
  }
</style>
</head>
<body>
<div id="map"></div>

<div class="legend">
  <div><div class="dot" style="background:#00ff9d;box-shadow:0 0 16px #00ff9d"></div> Done</div>
  <div><div class="dot" style="background:#ff3860;box-shadow:0 0 16px #ff3860"></div> To do</div>
</div>
<div class="progress" id="progress">0 / 9 completed</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('map', {zoomControl:false}).setView([-37.8176,144.9678],13);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  maxZoom:19,
  attribution:'© OpenStreetMap'
}).addTo(map);

// Ultra-pretty markers
const green = L.divIcon({className:'gmarker',html:`<div style="background:#00ff9d;width:30px;height:30px;border:5px solid white;border-radius:50%;box-shadow:0 0 20px #00ff9d;animation:pulse 2s infinite"></div>`,iconSize:[40,40],iconAnchor:[20,20]});
const red   = L.divIcon({className:'rmarker',html:`<div style="background:#ff3860;width:30px;height:30px;border:5px solid white;border-radius:50%;box-shadow:0 0 20px #ff3860;animation:pulse 2s infinite"></div>`,iconSize:[40,40],iconAnchor:[20,20]});

const places = [
  {id:1,name:"Federation Square / NGV Australia",lat:-37.8178,lng:144.9687,checked:true},
  {id:2,name:"Queen Victoria Market",lat:-37.8076,lng:144.9567},
  {id:3,name:"State Library Victoria",lat:-37.8098,lng:144.9652},
  {id:4,name:"Fortress Melbourne (Emporium)",lat:-37.8119,lng:144.9637},
  {id:5,name:"Laneways & Street Art (Hosier Lane)",lat:-37.8168,lng:144.9691},
  {id:6,name:"Docklands",lat:-37.8150,lng:144.9460},
  {id:7,name:"Royal Botanic Gardens",lat:-37.8334,lng:144.9803},
  {id:8,name:"South Melbourne Market",lat:-37.8350,lng:144.9600},
  {id:9,name:"St Kilda Beach & Pier",lat:-37.8679,lng:144.9740}
];

// Load saved progress
const saved = JSON.parse(localStorage.getItem("melb2025")||"{}");
places.forEach(p=>p.checked = saved[p.id]??p.checked??false);

function updateProgress(){
  const done = places.filter(p=>p.checked).length;
  document.getElementById("progress").textContent = `${done} / ${places.length} completed`;
}
updateProgress();

places.forEach(p=>{
  const marker = L.marker([p.lat,p.lng],{icon:p.checked?green:red}).addTo(map)
    .bindPopup(`<div style="font-family:system-ui;text-align:center">
      <b style="font-size:17px;color:#fff">${p.name}</b><br>
      <span style="color:${p.checked?'#00ff9d':'#ff3860'};font-weight:600">
        ${p.checked?'Done':'Click to check'}
      </span>
    </div>`,{closeButton:false,offset:[0,-10]});

  marker.on('click',()=>{
    p.checked = !p.checked;
    marker.setIcon(p.checked?green:red);
    marker.getPopup().setContent(`<div style="font-family:system-ui;text-align:center">
      <b style="font-size:17px;color:#fff">${p.name}</b><br>
      <span style="color:${p.checked?'#00ff9d':'#ff3860'};font-weight:600">
        ${p.checked?'Done':'Click to check'}
      </span>
    </div>`);
    const s={};places.forEach(x=>s[x.id]=x.checked);
    localStorage.setItem("melb2025",JSON.stringify(s));
    updateProgress();
  });
});

// Smooth zoom to all pins
map.fitBounds(L.featureGroup(places.map(p=>L.marker([p.lat,p.lng]))).getBounds().pad(0.15));

// Subtle pulse animation
const style=document.createElement('style');
style.textContent=`
@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(0,255,157,0.7)}70%{box-shadow:0 0 0 12px rgba(0,255,157,0)}100%{box-shadow:0 0 0 0 rgba(0,255,157,0)}}
.rmarker div{animation:pulse 2s infinite cubic-bezier(0.4,0,0.6,1)!important}
`;
document.head.appendChild(style);
</script>
</body>
</html>
